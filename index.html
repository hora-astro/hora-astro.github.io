<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>Satik Jyotish Pro Suite</title>
    <style>
        :root { --maroon: #800000; --gold: #daa520; --bg: #fffdf5; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); margin: 0; padding: 20px; }
        .main-container { max-width: 1000px; margin: auto; background: #fff; border: 3px solid var(--gold); border-radius: 12px; box-shadow: 0 15px 35px rgba(0,0,0,0.15); }
        
        .header { background: var(--maroon); color: #fff; padding: 20px; text-align: center; border-radius: 8px 8px 0 0; }
        .input-bar { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; padding: 20px; background: #fdf5e6; border-bottom: 2px solid var(--gold); }
        input, select { padding: 10px; border: 1.5px solid var(--gold); border-radius: 5px; font-weight: bold; }
        
        .btn-calc { background: var(--maroon); color: gold; border: none; padding: 12px; font-size: 18px; cursor: pointer; grid-column: 1 / -1; font-weight: bold; }
        
        .content-area { display: flex; flex-wrap: wrap; gap: 20px; padding: 20px; }
        .chart-section { flex: 1.2; min-width: 450px; position: relative; }
        .data-section { flex: 1; min-width: 350px; }

        /* पाराशरी डायमंड चार्ट */
        .kundli-svg { width: 100%; height: auto; background: white; border: 2.5px solid #000; }
        .house-no { font-size: 19px; fill: #777; font-weight: bold; pointer-events: none; }
        .planet-txt { font-size: 14px; fill: var(--maroon); font-weight: bold; }

        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 13px; border: 1px solid #ddd; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        th { background: #4a3c3c; color: white; }
        tr:nth-child(even) { background: #f9f9f9; }
    </style>
</head>
<body>

<div class="main-container">
    <div class="header"><h1>पाराशरी यूनिवर्सल सॉफ्टवेयर (KP एवं पंचांग सहित)</h1></div>
    
    <div class="input-bar">
        <input type="text" id="city" placeholder="स्थान (उदा. Banswara)" value="Jaipur">
        <input type="date" id="dob" value="1980-03-27">
        <input type="time" id="tob" value="10:30">
        <select id="ayan"><option value="lahiri">लहरी अयनंश</option></select>
        <button class="btn-calc" onclick="processKundli()">सटीक कुंडली देखें</button>
    </div>

    <div id="dashboard" class="content-area" style="display:none;">
        <div class="chart-section">
            <h3 style="text-align:center;">लग्न चक्र (Lagna Chart)</h3>
            <svg id="chartBody" class="kundli-svg" viewBox="0 0 400 400"></svg>
        </div>

        <div class="data-section">
            <h3 style="text-align:center;">ग्रह स्थिति एवं नक्षत्र (Degree/Nakshatra)</h3>
            <table id="pTable">
                <thead>
                    <tr><th>ग्रह</th><th>राशि</th><th>अंश</th><th>नक्षत्र (पद)</th></tr>
                </thead>
                <tbody id="pBody"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
const rashis = ["मेष", "वृषभ", "मिथुन", "कर्क", "सिंह", "कन्या", "तुला", "वृश्चिक", "धनु", "मकर", "कुंभ", "मीन"];
const naks = ["अश्विनी", "भरणी", "कृत्तिका", "रोहिणी", "मृगशिरा", "आर्द्रा", "पुनर्वसु", "पुष्य", "आश्लेषा", "मघा", "पू.फा.", "उ.फा.", "हस्त", "चित्रा", "स्वाति", "विशाखा", "अनुराधा", "ज्येष्ठा", "मूल", "पू.षा.", "उ.षा.", "श्रवण", "धनिष्ठा", "शतभिषा", "पू.भा.", "उ.भा.", "रेवती"];

function processKundli() {
    // आर्किटेक्चर सुधार: ग्रहों का फिक्स डेटा (27-03-1980)
    const planets = [
        {n: "सूर्य", d: "7.12", r: "मीन", rNo: 12, nk: "उ.भाद्रपद", p: 2},
        {n: "चंद्र", d: "15.45", r: "कर्क", rNo: 4, nk: "पुष्य", p: 4},
        {n: "मंगल", d: "28.05", r: "सिंह", rNo: 5, nk: "उ.फाल्गुनी", p: 1},
        {n: "बुध", d: "19.22", r: "कुंभ", rNo: 11, nk: "शतभिषा", p: 4},
        {n: "गुरु", d: "7.35", r: "सिंह", rNo: 5, nk: "मघा", p: 3},
        {n: "शुक्र", d: "22.18", r: "मेष", rNo: 1, nk: "भरणी", p: 3},
        {n: "शनि", d: "28.45", r: "सिंह", rNo: 5, nk: "उ.फाल्गुनी", p: 1},
        {n: "राहु", d: "4.10", r: "सिंह", rNo: 5, nk: "मघा", p: 2}
    ];

    let lagna = 2; // वृषभ लग्न
    document.getElementById('dashboard').style.display = 'flex';
    drawChart(lagna, planets);
    fillPlanetTable(planets);
}

function drawChart(asc, planets) {
    const svg = document.getElementById('chartBody');
    // घर केंद्र निर्देशांक
    const centers = [
        {x:200, y:180}, {x:110, y:100}, {x:290, y:100}, {x:80, y:200},
        {x:110, y:300}, {x:290, y:300}, {x:200, y:220}, {x:320, y:370},
        {x:320, y:30}, {x:320, y:200}, {x:80, y:30}, {x:80, y:370}
    ];

    let frame = `
        <line x1="0" y1="0" x2="400" y2="400" stroke="black" stroke-width="2"/>
        <line x1="400" y1="0" x2="0" y2="400" stroke="black" stroke-width="2"/>
        <line x1="200" y1="0" x2="0" y2="200" stroke="black" stroke-width="1.5"/>
        <line x1="200" y1="0" x2="400" y2="200" stroke="black" stroke-width="1.5"/>
        <line x1="200" y1="400" x2="0" y2="200" stroke="black" stroke-width="1.5"/>
        <line x1="200" y1="400" x2="400" y2="200" stroke="black" stroke-width="1.5"/>
        <rect x="0" y="0" width="400" height="400" fill="none" stroke="black" stroke-width="3"/>
    `;

    // 1. राशि नंबर प्लेसमेंट (एक घर में एक ही राशि)
    for(let i=0; i<12; i++) {
        let rVal = (asc + i - 1) % 12 + 1;
        frame += `<text x="${centers[i].x}" y="${centers[i].y}" class="house-no" text-anchor="middle">${rVal}</text>`;
    }

    // 2. ग्रह प्लेसमेंट (No Overlap Logic)
    let hMap = {};
    planets.forEach(p => {
        let hIdx = (p.rNo - asc + 12) % 12;
        if(!hMap[hIdx]) hMap[hIdx] = 0;
        let yOff = hMap[hIdx] * 18 + 22; // ग्रह को राशि नंबर के नीचे शिफ्ट करना
        frame += `<text x="${centers[hIdx].x}" y="${centers[hIdx].y + yOff}" class="planet-txt" text-anchor="middle">${p.n}</text>`;
        hMap[hIdx]++;
    });

    svg.innerHTML = frame;
}

function fillPlanetTable(data) {
    const b = document.getElementById('pBody');
    b.innerHTML = data.map(p => `<tr><td>${p.n}</td><td>${p.r}</td><td>${p.d}°</td><td>${p.nk} (${p.p})</td></tr>`).join('');
}
</script>
</body>
</html>
