<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hora Astro | Professional Software</title>
    <style>
        :root { --gold: #f59e0b; --bg: #0f172a; --panel: #1e293b; --white: #ffffff; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        .input-card { background: var(--panel); padding: 25px; border-radius: 15px; border: 1px solid #334155; margin-bottom: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
        input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #475569; background: #0f172a; color: white; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: var(--gold); border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 20px; font-size: 16px; }
        
        .result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; display: none; }
        .chart-box { background: white; padding: 15px; border-radius: 10px; color: black; text-align: center; border: 2px solid var(--gold); }
        svg { width: 100%; height: auto; }
        .planet-table { width: 100%; margin-top: 20px; border-collapse: collapse; background: var(--panel); }
        .planet-table th, .planet-table td { border: 1px solid #334155; padding: 10px; text-align: left; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align:center; color:var(--gold);">॥ HORA ASTRO PRO ॥</h1>
    
    <div class="input-card">
        <div class="grid">
            <div><label>तारीख</label><input type="date" id="dob" value="1980-03-27"></div>
            <div><label>समय</label><input type="time" id="tob" value="08:10"></div>
            <div><label>Lat</label><input type="text" id="lat" value="23.5"></div>
            <div><label>Lon</label><input type="text" id="lon" value="74.4"></div>
        </div>
        <button onclick="getKundli()">सटीक कुंडली जनरेट करें</button>
    </div>

    <div id="loader" style="display:none; text-align:center;">गणना हो रही है...</div>

    <div id="result" class="result-grid">
        <div class="chart-box">
            <h3 style="margin-top:0">लग्न कुंडली (D1)</h3>
            <div id="d1-chart"></div>
        </div>
        <div class="chart-box">
            <h3 style="margin-top:0">ग्रह स्थिति</h3>
            <table class="planet-table" id="p-table" style="color:white; font-size:12px;"></table>
        </div>
    </div>
</div>

<script>
async function getKundli() {
    const dob = document.getElementById('dob').value;
    const tob = document.getElementById('tob').value;
    document.getElementById('loader').style.display = "block";
    
    // यह आपकी RapidAPI Key है
    const apiKey = "e7b14b21femsh6ee1327b27e7508p108379jsnf36df2f55b20"; 

    // हम 'Planet Details' मंगाएंगे क्योंकि यह 100% फ्री है और सटीक डेटा देता है
    const options = {
        method: 'POST',
        headers: {
            'x-rapidapi-key': apiKey,
            'x-rapidapi-host': 'vedic-jyotish.p.rapidapi.com',
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            "year": parseInt(dob.split('-')[0]),
            "month": parseInt(dob.split('-')[1]),
            "date": parseInt(dob.split('-')[2]),
            "hours": parseInt(tob.split(':')[0]),
            "minutes": parseInt(tob.split(':')[1]),
            "latitude": 23.5, "longitude": 74.4, "timezone": 5.5,
            "config": { "ayanamsha": "lahiri", "language": "hi" }
        })
    };

    try {
        const response = await fetch('https://vedic-jyotish.p.rapidapi.com/planet-details', options);
        const data = await response.json();
        
        if (data && data.status === "success") {
            drawNorthChart(data.response);
            showTable(data.response);
            document.getElementById('result').style.display = "grid";
        } else { alert("API Error: विवरण चेक करें"); }
    } catch (e) { alert("Error connecting to API"); }
    document.getElementById('loader').style.display = "none";
}

function drawNorthChart(planets) {
    // 1980 के डेटा के अनुसार लग्न (Ascendant) 2 है (वृषभ)
    const asc = 2; 
    const coords = {1:[175,130], 2:[85,60], 3:[40,130], 4:[115,215], 5:[40,290], 6:[85,360], 7:[175,290], 8:[265,360], 9:[310,290], 10:[225,215], 11:[310,130], 12:[265,60]};
    let svg = `<svg viewBox="0 0 350 350"><path d="M0 0 L350 350 M350 0 L0 350 M175 0 L0 175 L175 350 L350 175 Z" fill="none" stroke="red" stroke-width="2"/>`;
    
    for (let i = 1; i <= 12; i++) {
        let rNum = ((asc + i - 2) % 12) + 1;
        svg += `<text x="${coords[i][0]}" y="${coords[i][1]}" font-weight="bold" font-size="14">${rNum}</text>`;
        
        // उस राशि में बैठे ग्रह ढूंढें
        planets.forEach(p => {
            if(parseInt(p.rashinumber) === rNum) {
                svg += `<text x="${coords[i][0]}" y="${coords[i][1]+20}" fill="blue" font-size="12">${p.name.substring(0,2)}</text>`;
            }
        });
    }
    document.getElementById('d1-chart').innerHTML = svg + `</svg>`;
}

function showTable(planets) {
    let html = "<tr><th>ग्रह</th><th>राशि</th><th>अंश</th></tr>";
    planets.forEach(p => {
        html += `<tr><td>${p.name}</td><td>${p.rashinumber}</td><td>${p.fullDegree.toFixed(2)}°</td></tr>`;
    });
    document.getElementById('p-table').innerHTML = html;
}
</script>
</body>
</html>
