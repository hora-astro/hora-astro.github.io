<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Vedic Kundli Demo (Lahiri)</title>
</head>
<body>
<h2>Vedic Kundli Demo – Lahiri Ayanamsa</h2>

<p><b>Date:</b> 27 March 1980<br>
<b>Time:</b> 08:10 AM IST<br>
<b>Place:</b> Banswara, Rajasthan (24.48N, 74.44E)</p>

<button onclick="calculate()">Calculate</button>

<pre id="out"></pre>

<script>
/* ---- Utility Functions ---- */

function toRadians(d){ return d*Math.PI/180; }
function toDegrees(r){ return r*180/Math.PI; }

/* Approximate Lahiri Ayanamsa */
function lahiriAyanamsa(JD){
  return 22.460148 + 1.396042*( (JD-2415020)/36525 );
}

/* Julian Date calculator */
function julianDate(y,m,d,ut){
  if(m<=2){ y-=1; m+=12;}
  let A=Math.floor(y/100);
  let B=2-A+Math.floor(A/4);
  return Math.floor(365.25*(y+4716))+Math.floor(30.6001*(m+1))+d+ut/24+B-1524.5;
}

/* Moon longitude (Meeus simplified) */
function moonLongitude(JD){
  let T=(JD-2451545)/36525;
  let L=218.3164477+481267.88123421*T;
  let M=134.9629814+477198.8673981*T;
  let F=93.2719103+483202.0175381*T;
  return (L
    +6.289*Math.sin(toRadians(M))
    +1.274*Math.sin(toRadians(2*L-M))
    +0.658*Math.sin(toRadians(2*L))
    +0.214*Math.sin(toRadians(2*M))
    +0.11 *Math.sin(toRadians(L))
  )%360;
}

/* Ascendant */
function ascendant(JD,lat,lon){
  let T=(JD-2451545)/36525;
  let eps=23.439291-0.0130042*T;
  let GMST=18.697374558+24.06570982441908*(JD-2451545);
  let LST=(GMST+lon/15)%24;
  let theta=LST*15;
  let tanA=(Math.sin(toRadians(theta)) /
           (Math.cos(toRadians(theta))*Math.sin(toRadians(eps))
            -Math.tan(toRadians(lat))*Math.cos(toRadians(eps))));
  return (toDegrees(Math.atan(tanA))+360)%360;
}

/* Main */
function calculate(){

  // ---- INPUT ----
  let Y=1980, M=3, D=27;

  // 08:10 IST → UTC = -5:30
  let h=8, min=10;
  let UT=h+min/60-5.5;

  // Banswara coordinates
  let lat=24.48;
  let lon=74.44;

  let JD=julianDate(Y,M,D,UT);

  let aya=lahiriAyanamsa(JD);

  let moonT=moonLongitude(JD);
  let moonS=(moonT-aya+360)%360;

  let ascT=ascendant(JD,lat,lon);
  let ascS=(ascT-aya+360)%360;

  function rashi(x){
    let r=["Mesha","Vrishabha","Mithun","Karka","Simha","Kanya","Tula","Vrischik","Dhanu","Makar","Kumbh","Meen"];
    return r[Math.floor(x/30)];
  }

  document.getElementById("out").innerText =
    "Julian Date: "+JD.toFixed(5)+"\n\n"+
    "Sidereal Moon: "+moonS.toFixed(2)+"°  →  "+rashi(moonS)+"\n"+
    "Sidereal Lagna: "+ascS.toFixed(2)+"° →  "+rashi(ascS);
}
</script>
</body>
</html>
