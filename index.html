<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Astro Prediction</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap (optional but good UI) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

<style>
body{
 background:#f5f5f5;
}
.card{
 margin-top:20px;
}
</style>

<!-- Google Places API (replace YOUR_KEY if you have one) -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY&libraries=places"></script>

</head>
<body>

<div class="container">

<h2 class="mt-3 text-center">Kundli & Astro Prediction</h2>

<div class="card">
<div class="card-body">

<div class="row">

<div class="col-md-4">
<label>Date of Birth</label>
<input type="date" id="dob" class="form-control">
</div>

<div class="col-md-4">
<label>Time of Birth</label>
<input type="time" id="tob" class="form-control">
</div>

<div class="col-md-4">
<label>Birth Place</label>
<input type="text" id="place" class="form-control">
</div>

</div>

<button class="btn btn-primary mt-3" onclick="getKundli()">Get Prediction</button>

</div>
</div>


<!-- RESULT AREA -->
<div class="card" id="result" style="display:none;">
<div class="card-body">

<h5>Lagna: <span id="lagna"></span></h5>
<p><b>D1 Chart:</b> <span id="d1"></span></p>
<p><b>D9 Chart:</b> <span id="d9"></span></p>
<p><b>Panchang:</b> <span id="panchang"></span></p>
<p><b>Vimshottari Dasha:</b> <span id="dasha"></span></p>

</div>
</div>

</div>

<script>
let lat = 0;
let lon = 0;

function initPlace(){
   let autocomplete = new google.maps.places.Autocomplete(
       document.getElementById("place")
   );

   autocomplete.addListener("place_changed", ()=>{
       let place = autocomplete.getPlace();
       lat = place.geometry.location.lat();
       lon = place.geometry.location.lng();
   });
}

window.onload = initPlace;


async function getKundli(){

   let dob = document.getElementById("dob").value;
   let tob = document.getElementById("tob").value;

   if(lat === 0 || lon === 0){
      alert("Please select location from suggestion list");
      return;
   }

   let res = await fetch("https://hemantpurohit27.pythonanywhere.com/api/kundli",{
        method:"POST",
        headers:{
          "Content-Type":"application/json"
        },
        body:JSON.stringify({
            dob:dob,
            tob:tob,
            lat:lat,
            lon:lon,
            timezone:"Asia/Kolkata"
        })
   });

   let data = await res.json();

   document.getElementById("lagna").innerText = data.lagna;
   document.getElementById("d1").innerText = data.d1;
   document.getElementById("d9").innerText = data.d9;
   document.getElementById("panchang").innerText = data.panchang;
   document.getElementById("dasha").innerText = data.dasha;

   document.getElementById("result").style.display="block";
}
</script>

</body>
</html>
