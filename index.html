<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>AstroWorkstation Pro V210</title>
    <style>
        :root { --accent: #f59e0b; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: grid; grid-template-columns: 240px 1fr; height: 100vh; }
        
        /* Sidebar Navigation */
        .sidebar { background: #020617; padding: 20px; border-right: 1px solid #334155; }
        .sidebar h2 { color: var(--accent); font-size: 18px; text-transform: uppercase; letter-spacing: 1px; }
        .nav-link { padding: 12px; margin: 8px 0; cursor: pointer; border-radius: 6px; transition: 0.2s; color: #94a3b8; }
        .nav-link:hover, .nav-link.active { background: var(--card); color: var(--accent); font-weight: bold; }

        /* Workspace */
        .workspace { padding: 20px; overflow-y: auto; }
        .top-shelf { display: flex; gap: 10px; margin-bottom: 20px; background: var(--card); padding: 15px; border-radius: 8px; align-items: center; }
        input { background: #0f172a; border: 1px solid #334155; color: white; padding: 8px; border-radius: 4px; }
        
        /* Professional Chart Grid */
        .chart-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 20px; }
        .chart-container { background: white; border-radius: 12px; padding: 15px; color: black; position: relative; }
        .chart-title { position: absolute; top: 10px; left: 10px; font-weight: bold; color: #7c2d12; font-size: 14px; }

        /* Data Tables */
        .data-card { background: var(--card); border-radius: 8px; padding: 15px; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; color: var(--accent); border-bottom: 1px solid #334155; padding: 10px; }
        td { padding: 10px; border-bottom: 1px solid #1e293b; font-family: monospace; }
        
        .dasha-badge { background: #064e3b; color: #34d399; padding: 4px 8px; border-radius: 4px; font-size: 12px; }
        #locList { position: absolute; background: white; color: black; z-index: 100; border-radius: 4px; width: 250px; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>ASTRO WORKSTATION</h2>
    <div class="nav-link active">üè† ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</div>
    <div class="nav-link">‚ò∏Ô∏è ‡§≤‡§ó‡•ç‡§® ‡§µ ‡§®‡§µ‡§Æ‡§æ‡§Ç‡§∂</div>
    <div class="nav-link">üìâ ‡§≠‡§æ‡§µ ‡§ö‡§≤‡§ø‡§§ (KP)</div>
    <div class="nav-link">‚è≥ ‡§µ‡§ø‡§Ç‡§∂‡•ã‡§§‡•ç‡§§‡§∞‡•Ä ‡§¶‡§∂‡§æ</div>
    <div class="nav-link">üìî ‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó ‡§µ‡§ø‡§µ‡§∞‡§£</div>
    <div class="nav-link">üñ®Ô∏è ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§ï‡§∞‡•á‡§Ç</div>
</div>

<div class="workspace">
    <div class="top-shelf">
        <input type="text" id="vName" placeholder="‡§®‡§æ‡§Æ" value="Hemant Purohit" style="width:120px;">
        <div style="position:relative;">
            <input type="text" id="vCity" placeholder="‡§∂‡§π‡§∞ ‡§ñ‡•ã‡§ú‡•á‡§Ç..." oninput="geoFind()">
            <div id="locList"></div>
        </div>
        <input type="date" id="vDate" value="1980-03-27">
        <input type="time" id="vTime" value="08:10">
        <button onclick="bootSoftware()" style="background:var(--accent); border:none; padding:9px 20px; border-radius:4px; cursor:pointer; font-weight:bold;">‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü</button>
    </div>

    <div id="softwareUI" style="display:none;">
        <div class="header-banner" style="margin-bottom:15px; font-size:20px;">
            <span id="outName" style="color:var(--accent); font-weight:bold;"></span> | 
            <span id="outPlace" style="font-size:14px; opacity:0.8;"></span>
        </div>

        <div class="chart-grid">
            <div class="chart-container">
                <div class="chart-title">D1 - LAGNA CHART</div>
                <div id="d1Draw"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">D9 - NAVAMSHA</div>
                <div id="d9Draw"></div>
            </div>
        </div>

        <div class="data-card">
            <h3>‡§®‡§ø‡§∞‡§Ø‡§£ ‡§ó‡•ç‡§∞‡§π ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü (KP Sidereal)</h3>
            <table>
                <thead>
                    <tr><th>‡§ó‡•ç‡§∞‡§π</th><th>‡§∞‡§æ‡§∂‡§ø</th><th>‡§Ö‡§Ç‡§∂ / ‡§ï‡§≤‡§æ</th><th>‡§¶‡§∂‡§æ ‡§∏‡•ç‡§µ‡§æ‡§Æ‡•Ä</th></tr>
                </thead>
                <tbody id="pData"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    let uLat = 24.58, uLng = 73.71;

    async function geoFind() {
        const q = document.getElementById('vCity').value;
        if(q.length < 3) return;
        const r = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${q}`);
        const d = await r.json();
        const box = document.getElementById('locList'); box.innerHTML = ""; box.style.display="block";
        d.forEach(i => {
            let div = document.createElement('div'); div.style.padding="8px"; div.style.cursor="pointer"; div.style.borderBottom="1px solid #eee";
            div.innerText = i.display_name;
            div.onclick = () => { uLat=i.lat; uLng=i.lon; document.getElementById('vCity').value=i.display_name.split(',')[0]; box.style.display="none"; };
            box.appendChild(div);
        });
    }

    async function bootSoftware() {
        const url = `https://hemantpurohit27.pythonanywhere.com/api/v210?date=${document.getElementById('vDate').value}&time=${document.getElementById('vTime').value}&lat=${uLat}&lng=${uLng}`;
        const res = await fetch(url);
        const data = await res.json();
        
        document.getElementById('softwareUI').style.display = "block";
        document.getElementById('outName').innerText = document.getElementById('vName').value;
        document.getElementById('outPlace').innerText = document.getElementById('vCity').value + " (Dasha: " + data.dasha.maha_dasha + ")";

        let rows = "";
        data.planets.forEach(p => {
            rows += `<tr><td>${p.name}</td><td>${p.d1}</td><td>${Math.floor(p.deg%30)}¬∞ ${Math.floor((p.deg%1)*60)}'</td><td>${p.name==='‡§ö‡§Ç‡§¶‡•ç‡§∞'? `<span class="dasha-badge">${data.dasha.maha_dasha}</span>` : '-'}</td></tr>`;
        });
        document.getElementById('pData').innerHTML = rows;

        renderChart("d1Draw", data.asc, data.planets, "d1");
        renderChart("d9Draw", 1, data.planets, "d9");
    }

    function renderChart(divId, asc, planets, key) {
        const h = {1:[175,130], 2:[85,60], 3:[40,130], 4:[115,215], 5:[40,290], 6:[85,360], 7:[175,290], 8:[265,360], 9:[310,290], 10:[225,215], 11:[310,130], 12:[265,60]};
        let svg = `<svg viewBox="0 0 350 350" width="100%"><path d="M0 0 L350 350 M350 0 L0 350 M175 0 L0 175 L175 350 L350 175 Z" fill="none" stroke="#7c2d12" stroke-width="2.5"/>`;
        for (let i = 1; i <= 12; i++) {
            let s = ((asc + i - 2) % 12) + 1;
            svg += `<text x="${h[i][0]}" y="${h[i][1]}" fill="#7c2d12" font-weight="bold" font-size="22" text-anchor="middle">${s}</text>`;
            planets.filter(pl => pl[key] === s).forEach((pl, idx) => {
                svg += `<text x="${h[i][0]}" y="${h[i][1] + 25 + (idx*16)}" fill="#1e40af" font-size="12" font-weight="bold" text-anchor="middle">${pl.name}</text>`;
            });
        }
        document.getElementById(divId).innerHTML = svg + `</svg>`;
    }
</script>
</body>
</html>
