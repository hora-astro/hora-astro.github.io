<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>Professional Vedic Engine</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f4f9; padding: 20px; }
        .grid-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .kundli-svg { width: 100%; max-width: 450px; }
        h2 { color: #b91c1c; border-bottom: 2px solid #b91c1c; padding-bottom: 5px; }
        @media (max-width: 800px) { .grid-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div class="card" style="margin-bottom:20px;">
        <input type="text" id="city" placeholder="शहर">
        <input type="date" id="dob">
        <input type="time" id="tob">
        <button onclick="fetchKundli()">प्रोफेशनल कुंडली प्राप्त करें</button>
    </div>

    <div id="result" class="grid-layout" style="display:none;">
        <div class="card">
            <h2>लग्न कुंडली (D-1)</h2>
            <div id="d1Chart"></div>
        </div>
        <div class="card">
            <h2>नवांश कुंडली (D-9)</h2>
            <div id="d9Chart"></div>
        </div>
        <div class="card" style="grid-column: 1 / -1;">
            <h2>विंशोत्तरी दशा एवं विस्तृत फलादेश</h2>
            <p id="dashaInfo" style="font-weight:bold; font-size:18px; color: #b91c1c;"></p>
            <div id="prediction" style="line-height:1.6; color:#333;"></div>
        </div>
    </div>

<script>
async function fetchKundli() {
    // ... (Your Fetch Logic) ...
    // Assume data is received in 'data' variable
    renderAll(data);
}

function renderAll(data) {
    document.getElementById('result').style.display = 'grid';
    document.getElementById('dashaInfo').innerText = data.dasha;
    
    // Charts
    drawChart('d1Chart', data.lagna, data.planets, 'rIdx');
    drawChart('d9Chart', data.lagna_d9, data.planets, 'd9Idx');
    
    // फलदेश (Professional Logic)
    generatePrediction(data);
}

function drawChart(containerId, lagna, planets, key) {
    const centers = {1:[200,160], 2:[100,70], 3:[50,140], 4:[150,210], 5:[50,280], 6:[100,350], 7:[200,260], 8:[300,350], 9:[350,280], 10:[250,210], 11:[350,140], 12:[300,70]};
    let svg = `<svg viewBox="0 0 400 400" class="kundli-svg" xmlns="http://www.w3.org/2000/svg">
        <rect width="400" height="400" fill="#fff" stroke="#000" stroke-width="2"/>
        <line x1="0" y1="0" x2="400" y2="400" stroke="#000"/> <line x1="400" y1="0" x2="0" y2="400" stroke="#000"/>
        <line x1="200" y1="0" x2="0" y2="200" stroke="#000"/> <line x1="200" y1="0" x2="400" y2="200" stroke="#000"/>
        <line x1="0" y1="200" x2="200" y2="400" stroke="#000"/> <line x1="200" y1="400" x2="400" y2="200" stroke="#000"/>`;

    for(let i=1; i<=12; i++) {
        let r = (lagna + i - 1); if(r > 12) r -= 12;
        svg += `<text x="${centers[i][0]}" y="${centers[i][1]}" fill="red" font-weight="bold" font-size="22" text-anchor="middle">${r}</text>`;
        
        // ग्रहों की सटीक प्लेसमेंट (Vertical Stacking)
        let pInHouse = planets.filter(p => p[key] === r);
        pInHouse.forEach((p, idx) => {
            svg += `<text x="${centers[i][0]}" y="${centers[i][1] + 25 + (idx * 16)}" font-size="13" text-anchor="middle" font-weight="600">${p.name}</text>`;
        });
    }
    svg += `</svg>`;
    document.getElementById(containerId).innerHTML = svg;
}

function generatePrediction(data) {
    let pText = "<b>साधारण फलादेश:</b><br>";
    const sun = data.planets.find(p => p.name === "सूर्य");
    if(sun.rIdx === 1) pText += "• सूर्य लग्न में होने से आप तेजस्वी और स्वाभिमानी होंगे।<br>";
    if(data.lagna === 2) pText += "• वृषभ लग्न स्थिर स्वभाव और आर्थिक समृद्धि का संकेत देता है।<br>";
    document.getElementById('prediction').innerHTML = pText + "<i>(विस्तृत फलादेश के लिए ग्रहों की युति और दृष्टि का विश्लेषण आवश्यक है)</i>";
}
</script>
</body>
</html>
