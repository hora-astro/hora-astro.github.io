<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hora Astro Pro | D1, D9 & Panchang</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --primary: #e64a19; --secondary: #5d4037; --bg: #fffbf0; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding: 10px; }
        .container { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        
        /* Navigation Tabs */
        .tabs { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 20px; border-bottom: 2px solid #eee; }
        .tab-btn { padding: 10px 15px; border: none; background: #eee; cursor: pointer; border-radius: 8px 8px 0 0; font-weight: bold; }
        .tab-btn.active { background: var(--primary); color: white; }

        /* Chart Grid */
        .chart-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .chart-card { border: 1px solid #ddd; padding: 10px; border-radius: 10px; text-align: center; }
        
        /* Tables */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f4f4f4; }

        .btn-download { background: #2e7d32; color: white; padding: 12px; border: none; width: 100%; border-radius: 8px; cursor: pointer; font-size: 16px; margin-top: 20px; }
        .form-group { margin-bottom: 15px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        
        .kundli-svg { width: 100%; max-width: 300px; height: auto; border: 2px solid #333; }
    </style>
</head>
<body>

<div class="container" id="printable-area">
    <h1 style="color:var(--primary); text-align:center;">Hora Astro Pro üåå</h1>
    
    <div class="no-print">
        <div class="form-group"><input type="text" id="name" placeholder="‡§®‡§æ‡§Æ"></div>
        <div class="chart-grid">
            <div class="form-group"><input type="date" id="dob"></div>
            <div class="form-group"><input type="time" id="tob"></div>
        </div>
        <div class="form-group"><input type="text" id="city" placeholder="‡§ú‡§®‡•ç‡§Æ ‡§∏‡•ç‡§•‡§æ‡§® (City)"></div>
        <button onclick="generateAll()" style="background:var(--primary); color:white; padding:12px; width:100%; border:none; border-radius:8px; cursor:pointer; font-weight:bold;">‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
    </div>

    <div class="tabs no-print" style="margin-top:25px;">
        <button class="tab-btn active" onclick="showTab('charts')">D1/D9 ‡§ö‡§æ‡§∞‡•ç‡§ü‡•ç‡§∏</button>
        <button class="tab-btn" onclick="showTab('panchang')">‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó</button>
        <button class="tab-btn" onclick="showTab('dasha')">‡§µ‡§ø‡§Ç‡§∂‡•ã‡§§‡•ç‡§§‡§∞‡•Ä ‡§¶‡§∂‡§æ</button>
        <button class="tab-btn" onclick="showTab('milan')">‡§ó‡•Å‡§£ ‡§Æ‡§ø‡§≤‡§æ‡§®</button>
    </div>

    <div id="charts" class="tab-content">
        <div class="chart-grid">
            <div class="chart-card">
                <h3>‡§≤‡§ó‡•ç‡§® ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä (D1)</h3>
                <div id="d1-chart">üìä ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§Ø‡§π‡§æ‡§Å ‡§≤‡•ã‡§° ‡§π‡•ã‡§ó‡§æ...</div>
            </div>
            <div class="chart-card">
                <h3>‡§®‡§µ‡§æ‡§Ç‡§∂ ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä (D9)</h3>
                <div id="d9-chart">üìä ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§Ø‡§π‡§æ‡§Å ‡§≤‡•ã‡§° ‡§π‡•ã‡§ó‡§æ...</div>
            </div>
        </div>
    </div>

    <div id="panchang" class="tab-content" style="display:none;">
        <h3>‡§Ü‡§ú ‡§ï‡§æ ‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó</h3>
        <table id="panchang-table">
            <tr><td>‡§§‡§ø‡§•‡§ø</td><td id="tithi">-</td></tr>
            <tr><td>‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞</td><td id="nakshatra">-</td></tr>
            <tr><td>‡§Ø‡•ã‡§ó</td><td id="yoga">-</td></tr>
            <tr><td>‡§ï‡§∞‡§£</td><td id="karana">-</td></tr>
            <tr><td>‡§µ‡§æ‡§∞</td><td id="vaar">-</td></tr>
        </table>
    </div>

    <div id="dasha" class="tab-content" style="display:none;">
        <h3>‡§µ‡§ø‡§Ç‡§∂‡•ã‡§§‡•ç‡§§‡§∞‡•Ä ‡§Æ‡§π‡§æ‡§¶‡§∂‡§æ</h3>
        <table id="dasha-table">
            <thead><tr><th>‡§ó‡•ç‡§∞‡§π</th><th>‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§§‡§ø‡§•‡§ø</th><th>‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡§ø ‡§§‡§ø‡§•‡§ø</th></tr></thead>
            <tbody id="dasha-body"></tbody>
        </table>
    </div>

    <div id="milan" class="tab-content" style="display:none;">
        <h3>‡§Ö‡§∑‡•ç‡§ü‡§ï‡•Ç‡§ü ‡§Æ‡§ø‡§≤‡§æ‡§®</h3>
        <p>‡§Æ‡§ø‡§≤‡§æ‡§® ‡§∏‡•ç‡§ï‡•ã‡§∞: <strong id="milan-score">0 / 36</strong></p>
        <div id="milan-details"></div>
    </div>

    <button class="btn-download no-print" onclick="downloadPDF()">PDF ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç üìÑ</button>
</div>

<script>
    // Tab Switching Logic
    function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(tabId).style.display = 'block';
        event.currentTarget.classList.add('active');
    }

    // PDF Generation
    function downloadPDF() {
        const element = document.getElementById('printable-area');
        const opt = {
            margin:       10,
            filename:     'Kundli_HoraAstro.pdf',
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { scale: 2 },
            jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };
        // ‡§¨‡§ü‡§® ‡§õ‡•Å‡§™‡§æ‡§è‡§Ç
        document.querySelectorAll('.no-print').forEach(el => el.style.display = 'none');
        html2pdf().set(opt).from(element).save().then(() => {
            document.querySelectorAll('.no-print').forEach(el => el.style.display = 'block');
        });
    }

    // Mock API Call (‡§Ü‡§™‡§ï‡•ã ‡§á‡§∏‡•á ‡§Ö‡§™‡§®‡•á Prokerala API Backend ‡§∏‡•á ‡§ú‡•ã‡•ú‡§®‡§æ ‡§π‡•ã‡§ó‡§æ)
    async function generateAll() {
        // 1. ‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó ‡§°‡•á‡§ü‡§æ (Prokerala API /panchang)
        document.getElementById('tithi').innerText = "‡§∂‡•Å‡§ï‡•ç‡§≤ ‡§è‡§ï‡§æ‡§¶‡§∂‡•Ä";
        document.getElementById('nakshatra').innerText = "‡§∞‡•ã‡§π‡§ø‡§£‡•Ä";
        
        // 2. ‡§¶‡§∂‡§æ ‡§°‡•á‡§ü‡§æ (Prokerala API /vimsottari-dasha)
        const dashaBody = document.getElementById('dasha-body');
        dashaBody.innerHTML = `<tr><td>‡§ó‡•Å‡§∞‡•Å</td><td>2020-05-10</td><td>2036-05-10</td></tr>`;

        // 3. ‡§ö‡§æ‡§∞‡•ç‡§ü‡•ç‡§∏ (Prokerala API /horoscope-chart/d1)
        document.getElementById('d1-chart').innerHTML = `<svg viewBox="0 0 300 300" class="kundli-svg">
            <rect width="300" height="300" fill="none" stroke="#333" stroke-width="2"/>
            <line x1="0" y1="0" x2="300" y2="300" stroke="#333"/>
            <line x1="300" y1="0" x2="0" y2="300" stroke="#333"/>
            <text x="140" y="100" fill="red">10</text>
        </svg>`;
        
        alert("‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à! ‡§Ö‡§¨ ‡§Ü‡§™ ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§ü‡•à‡§¨‡•ç‡§∏ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§");
    }
</script>

</body>
</html>
