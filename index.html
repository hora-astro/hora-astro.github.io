<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>HORA ASTRO SUPREME V40.0</title>
    <style>
        :root { --gold: #f39c12; --dark: #0b0e14; --card: #1c2128; }
        body { background: var(--dark); color: white; font-family: 'Poppins', sans-serif; margin: 0; padding: 15px; }
        .header-panel { background: var(--card); border: 2px solid var(--gold); border-radius: 15px; padding: 20px; margin-bottom: 20px; }
        .input-group { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px; }
        input { background: #000; border: 1px solid #444; color: white; padding: 10px; border-radius: 5px; flex: 1; }
        .btn-calc { background: var(--gold); border: none; padding: 12px 30px; font-weight: bold; cursor: pointer; border-radius: 5px; width: 100%; }
        
        /* ‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó ‡§∞‡§ø‡§¨‡§® */
        .panchang-ribbon { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 20px; }
        .pan-item { background: linear-gradient(45deg, #f39c12, #d35400); color: black; padding: 10px; border-radius: 8px; text-align: center; font-weight: 800; font-size: 14px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }

        .kundli-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .chart-card { background: white; border-radius: 12px; padding: 15px; color: black; box-shadow: 0 0 20px rgba(243, 156, 18, 0.2); }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; background: var(--card); }
        th, td { border: 1px solid #333; padding: 12px; text-align: center; }
        th { background: #2d333b; color: var(--gold); }
    </style>
</head>
<body>

<div class="header-panel">
    <h2 align="center" style="color:var(--gold); margin-top:0;">üïâÔ∏è HORA ASTRO SUPREME V40.0</h2>
    <div class="input-group">
        <input type="text" id="uname" placeholder="‡§ú‡§æ‡§§‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ" value="Hemant Purohit">
        <input type="text" id="city" placeholder="‡§∂‡§π‡§∞ (‡§ú‡•à‡§∏‡•á: Banswara)" oninput="searchLoc(this.value)">
        <input type="date" id="udate" value="2006-11-06">
        <input type="time" id="utime" value="11:28">
    </div>
    <input type="hidden" id="lat" value="24.58">
    <input type="hidden" id="lng" value="73.71">
    <button class="btn-calc" onclick="runAstro()">‡§™‡•Ç‡§∞‡•ç‡§£ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§è‡§µ‡§Ç ‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
</div>

<div id="main-ui" style="display:none">
    <div class="panchang-ribbon" id="pan-ui"></div>

    <div class="kundli-grid">
        <div class="chart-card">
            <h3 align="center">‡§≤‡§ó‡•ç‡§® ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä (D1)</h3>
            <div id="d1-svg"></div>
        </div>
        <div class="chart-card">
            <h3 align="center">‡§®‡§µ‡§æ‡§Ç‡§∂ ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä (D9)</h3>
            <div id="d9-svg"></div>
        </div>
    </div>

    <div class="card" style="margin-top:20px;">
        <h3 style="color:var(--gold)">üìä ‡§ó‡•ç‡§∞‡§π ‡§è‡§µ‡§Ç ‡§≠‡§æ‡§µ ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§µ‡§ø‡§µ‡§∞‡§£</h3>
        <table id="p-table"></table>
    </div>
</div>

<script>
    async function runAstro() {
        const name = document.getElementById('uname').value;
        const res = await fetch(`https://hemantpurohit27.pythonanywhere.com/api/v40_final?name=${name}&date=${document.getElementById('udate').value}&time=${document.getElementById('utime').value}&lat=${document.getElementById('lat').value}&lng=${document.getElementById('lng').value}`);
        const d = await res.json();

        document.getElementById('main-ui').style.display = 'block';

        // ‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó UI
        document.getElementById('pan-ui').innerHTML = `
            <div class="pan-item">‡§®‡§æ‡§Æ: ${d.name}</div>
            <div class="pan-item">‡§∏‡§Ç‡§µ‡§§: ${d.panchang.samvat}</div>
            <div class="pan-item">‡§Æ‡§æ‡§π: ${d.panchang.month}</div>
            <div class="pan-item">‡§§‡§ø‡§•‡§ø: ${d.panchang.tithi} (${d.panchang.paksha})</div>
            <div class="pan-item">‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞: ${d.panchang.nakshatra} (${d.panchang.charan})</div>
        `;

        // ‡§ü‡•á‡§¨‡§≤ UI
        let phtml = `<tr><th>‡§ó‡•ç‡§∞‡§π</th><th>‡§Ö‡§Ç‡§∂</th><th>‡§≠‡§æ‡§µ</th></tr>`;
        d.planets.forEach(p => phtml += `<tr><td>${p.name}</td><td>${p.deg}¬∞</td><td>${p.house}</td></tr>`);
        document.getElementById('p-table').innerHTML = phtml;

        // ‡§ö‡§æ‡§∞‡•ç‡§ü‡•ç‡§∏
        document.getElementById('d1-svg').innerHTML = drawChart(d.asc, d.planets);
        document.getElementById('d9-svg').innerHTML = drawChart(8, d.planets); // ‡§®‡§µ‡§æ‡§Ç‡§∂ ‡§µ‡•É‡§∂‡•ç‡§ö‡§ø‡§ï ‡§≤‡§ó‡•ç‡§® ‡§™‡§∞
    }

    function drawChart(asc, planets) {
        const hPos = {1:[150,100], 2:[75,50], 3:[50,75], 4:[100,150], 5:[50,225], 6:[75,250], 7:[150,200], 8:[225,250], 9:[250,225], 10:[200,150], 11:[250,75], 12:[225,50]};
        let svg = `<svg viewBox="0 0 300 300" style="width:100%"><path d="M0 0 L300 300 M300 0 L0 300 M150 0 L0 150 L150 300 L300 150 Z" stroke="#333" fill="none" stroke-width="2"/>`;
        for(let i=1; i<=12; i++){
            let sign = ((asc + i - 2) % 12) + 1;
            svg += `<text x="${hPos[i][0]}" y="${hPos[i][1]}" fill="red" font-weight="bold" text-anchor="middle">${sign}</text>`;
            let p_names = planets.filter(p => p.house === i).map(p => p.name).join(' ');
            svg += `<text x="${hPos[i][0]}" y="${hPos[i][1]+18}" fill="#0056b3" font-size="9" font-weight="bold" text-anchor="middle">${p_names}</text>`;
        }
        return svg + `</svg>`;
    }
</script>
</body>
</html>
