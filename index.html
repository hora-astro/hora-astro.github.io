<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>Astro-Omni Supreme V25.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #ffb142; --dark: #1e272e; --white: #ffffff; }
        body { background: #050505; color: var(--white); font-family: 'Poppins', sans-serif; padding: 20px; }
        .input-panel { background: var(--dark); padding: 30px; border-radius: 20px; border: 2px solid var(--gold); display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 30px; box-shadow: 0 0 20px rgba(255,177,66,0.3); }
        input, button { padding: 15px; border-radius: 10px; border: none; font-size: 14px; }
        button { background: var(--gold); color: black; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(255,177,66,0.5); }
        .panchang-strip { background: var(--gold); color: black; padding: 15px; border-radius: 10px; display: flex; justify-content: space-around; font-weight: bold; margin-bottom: 25px; }
        .chart-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .chart-card { background: white; padding: 20px; border-radius: 15px; color: black; }
        svg { width: 100%; height: auto; }
        .prediction-box { background: #2f3542; padding: 25px; border-radius: 15px; border-left: 10px solid var(--gold); margin-top: 30px; }
        .location-results { position: absolute; background: white; color: black; width: 100%; z-index: 10; border-radius: 5px; }
        .loc-item { padding: 10px; cursor: pointer; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>

    <h1 align="center" style="color:var(--gold); letter-spacing: 2px;">üïâÔ∏è ASTRO-OMNI SUPREME V25.0</h1>

    <div class="input-panel">
        <input type="text" id="name" placeholder="‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç" value="‡§π‡•á‡§Æ‡§Ç‡§§ ‡§™‡•Å‡§∞‡•ã‡§π‡§ø‡§§">
        <div style="position:relative;">
            <input type="text" id="city" placeholder="‡§∂‡§π‡§∞ ‡§ñ‡•ã‡§ú‡•á‡§Ç..." oninput="searchCity(this.value)">
            <div id="loc_list" class="location-results"></div>
        </div>
        <input type="date" id="date" value="2006-11-06">
        <input type="time" id="time" value="11:28">
        <input type="hidden" id="lat" value="24.58">
        <input type="hidden" id="lng" value="73.71">
        <button onclick="generateKundli()">‡§∏‡§ü‡•Ä‡§ï ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£</button>
    </div>

    <div id="dashboard" style="display:none">
        <div class="panchang-strip" id="panchang_info"></div>

        <div class="chart-container">
            <div class="chart-card">
                <h3 align="center">D1 ‡§≤‡§ó‡•ç‡§® ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä</h3>
                <div id="d1_svg"></div>
            </div>
            <div class="chart-card">
                <h3 align="center">D9 ‡§®‡§µ‡§æ‡§Ç‡§∂ ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä</h3>
                <div id="d9_svg"></div>
            </div>
        </div>

        <div class="prediction-box">
            <h2 style="color:var(--gold)">üìú ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§´‡§≤‡§æ‡§¶‡•á‡§∂ (Advanced Analysis)</h2>
            <div id="preds" style="line-height: 2; font-size: 16px;"></div>
        </div>
    </div>

<script>
    async function searchCity(q) {
        if(q.length < 3) return;
        const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${q}`);
        const data = await res.json();
        document.getElementById('loc_list').innerHTML = data.map(i => `<div class="loc-item" onclick="setLoc(${i.lat},${i.lon},'${i.display_name}')">${i.display_name}</div>`).join('');
    }

    function setLoc(lat, lon, name) {
        document.getElementById('lat').value = lat;
        document.getElementById('lng').value = lon;
        document.getElementById('city').value = name;
        document.getElementById('loc_list').innerHTML = "";
    }

    async function generateKundli() {
        const url = `https://hemantpurohit27.pythonanywhere.com/api/advanced_kundli_v25?date=${document.getElementById('date').value}&time=${document.getElementById('time').value}&lat=${document.getElementById('lat').value}&lng=${document.getElementById('lng').value}`;
        const res = await fetch(url);
        const d = await res.json();

        document.getElementById('dashboard').style.display = 'block';
        document.getElementById('panchang_info').innerHTML = `<span>‡§§‡§ø‡§•‡§ø: ${d.panchang.tithi}</span> | <span>‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞: ${d.panchang.nakshatra}</span> | <span>‡§™‡§ï‡•ç‡§∑: ${d.panchang.paksha}</span>`;
        
        document.getElementById('d1_svg').innerHTML = drawChart(d.asc, d.planets, 'd1');
        document.getElementById('d9_svg').innerHTML = drawChart(d.d9_asc, d.planets, 'd9');

        // ‡§´‡§≤‡§æ‡§¶‡•á‡§∂ ‡§≤‡•â‡§ú‡§ø‡§ï
        let pText = `‚Ä¢ ‡§Ü‡§™‡§ï‡§æ ‡§ú‡§®‡•ç‡§Æ <b>${d.panchang.nakshatra}</b> ‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§π‡•Å‡§Ü ‡§π‡•à‡•§<br>`;
        pText += `‚Ä¢ ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä ‡§ï‡§æ ‡§≤‡§ó‡•ç‡§® <b>‡§ß‡§®‡•Å</b> ‡§π‡•à, ‡§ú‡•ã ‡§ú‡§æ‡§§‡§ï ‡§ï‡•ã ‡§ú‡•ç‡§û‡§æ‡§®‡§µ‡§æ‡§® ‡§î‡§∞ ‡§∏‡§æ‡§π‡§∏‡•Ä ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à‡•§<br>`;
        pText += `‚Ä¢ ‡§¶‡§∂‡§Æ ‡§≠‡§æ‡§µ ‡§Æ‡•á‡§Ç ‡§ó‡•ç‡§∞‡§π‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§Æ‡•á‡§Ç ‡§∏‡§´‡§≤‡§§‡§æ ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡•§`;
        document.getElementById('preds').innerHTML = pText;
    }

    function drawChart(asc, planets, mode) {
        const hPos = {1:[150,80], 2:[75,40], 3:[40,75], 4:[100,150], 5:[40,225], 6:[75,260], 7:[150,220], 8:[225,260], 9:[260,225], 10:[200,150], 11:[260,75], 12:[225,40]};
        let svg = `<svg viewBox="0 0 300 300"><path d="M0 0 L300 300 M300 0 L0 300 M150 0 L0 150 L150 300 L300 150 Z" stroke="#000" fill="none" stroke-width="2"/><rect width="300" height="300" fill="none" stroke="#000" stroke-width="3"/>`;
        
        for(let i=1; i<=12; i++) {
            let r = ((asc + i - 2) % 12) + 1;
            svg += `<text x="${hPos[i][0]}" y="${hPos[i][1]}" fill="red" font-weight="bold" font-size="16" text-anchor="middle">${r}</text>`;
        }

        let tracker = {};
        planets.forEach(p => {
            let sign = (mode==='d1') ? p.sign : p.d9;
            let house = ((sign - asc + 12) % 12) + 1;
            if(!tracker[house]) tracker[house] = 0;
            svg += `<text x="${hPos[house][0]}" y="${hPos[house][1] + 20 + (tracker[house]*15)}" fill="blue" font-size="11" font-weight="bold" text-anchor="middle">${p.name}</text>`;
            tracker[house]++;
        });
        return svg + "</svg>";
    }
</script>
</body>
</html>
